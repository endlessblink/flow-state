{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Frontend Layout Fixer Skill - I/O Schema",
  "description": "Input and output schema for the frontend layout fixer skill",

  "definitions": {
    "context_object": {
      "type": "object",
      "required": ["issue_description", "target_selector_hints", "constraints"],
      "properties": {
        "issue_description": {
          "type": "string",
          "description": "Natural language description of the visual bug (clipping, spacing, overflow, etc.)",
          "examples": ["Text in task cards is clipped at the top and bottom"]
        },
        "target_selector_hints": {
          "type": "array",
          "items": { "type": "string" },
          "minItems": 1,
          "description": "CSS selector hints (class names, IDs) likely involved in the issue",
          "examples": [[".task-card", ".card-title", ".card-meta"]]
        },
        "constraints": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Requirements that patches must NOT violate",
          "examples": [["Do not change colors", "Do not modify typography", "Preserve layout direction"]]
        },
        "viewport_width": {
          "type": "integer",
          "description": "Viewport width in pixels where issue occurs",
          "default": 1024,
          "examples": [360, 1024, 1920]
        },
        "viewport_height": {
          "type": "integer",
          "description": "Viewport height in pixels where issue occurs",
          "default": 768,
          "examples": [800, 768, 1080]
        }
      }
    },

    "css_patch": {
      "type": "object",
      "required": ["selector", "old_block", "new_block", "rationale"],
      "properties": {
        "selector": {
          "type": "string",
          "description": "CSS selector being modified",
          "examples": [".task-card", "#header", "div.card-body"]
        },
        "old_block": {
          "type": "string",
          "description": "Exact CSS rule block from current stylesheet (including selector and braces)",
          "examples": [".task-card {\n  height: 60px;\n  overflow: hidden;\n}"]
        },
        "new_block": {
          "type": "string",
          "description": "Full replacement CSS rule block (including selector and braces)",
          "examples": [".task-card {\n  min-height: 60px;\n  overflow: visible;\n}"]
        },
        "rationale": {
          "type": "string",
          "description": "Explanation of why this change fixes the issue",
          "examples": ["Changed height to min-height to allow expansion; removed overflow: hidden to prevent clipping"]
        }
      }
    },

    "html_patch": {
      "type": "object",
      "required": ["search", "replace", "rationale"],
      "properties": {
        "search": {
          "type": "string",
          "description": "Exact HTML snippet to find and replace",
          "examples": ["<div class=\"card\">", "<!-- old structure -->"]
        },
        "replace": {
          "type": "string",
          "description": "Replacement HTML snippet",
          "examples": ["<div class=\"card\" role=\"article\">"]
        },
        "rationale": {
          "type": "string",
          "description": "Explanation of why HTML change is necessary",
          "examples": ["Added flex container wrapper to properly contain content"]
        }
      }
    },

    "diagnosis": {
      "type": "object",
      "required": ["root_cause", "affected_selectors"],
      "properties": {
        "root_cause": {
          "type": "string",
          "description": "Identified root cause of the layout issue",
          "examples": ["Fixed height with overflow: hidden prevents multi-line content from displaying"]
        },
        "affected_selectors": {
          "type": "array",
          "items": { "type": "string" },
          "description": "List of CSS selectors being modified",
          "examples": [[".task-card", ".task-title"]]
        }
      }
    }
  },

  "input_schema": {
    "type": "object",
    "title": "Frontend Fixer Skill Input",
    "required": ["html", "css", "context"],
    "properties": {
      "html": {
        "type": "string",
        "description": "HTML source code (full document or component snippet)",
        "examples": ["<!doctype html>...", "<div class=\"card\">...</div>"]
      },
      "css": {
        "type": "string",
        "description": "CSS stylesheet (full or relevant excerpt, unminified preferred)",
        "examples": [".task-card { height: 60px; padding: 4px 12px; }"]
      },
      "context": {
        "$ref": "#/definitions/context_object"
      }
    }
  },

  "output_schema": {
    "type": "object",
    "title": "Frontend Fixer Skill Output",
    "required": ["explanation", "diagnosis", "css_patches", "html_patches", "testing_checklist"],
    "properties": {
      "explanation": {
        "type": "string",
        "description": "1-3 sentence summary of the diagnosis and fix",
        "examples": ["The task card has a fixed height of 60px with overflow: hidden, preventing multi-line content from displaying. Changing to min-height and removing overflow will expand the card to fit content."]
      },
      "diagnosis": {
        "$ref": "#/definitions/diagnosis"
      },
      "css_patches": {
        "type": "array",
        "items": { "$ref": "#/definitions/css_patch" },
        "description": "Array of CSS patches to apply in order"
      },
      "html_patches": {
        "type": "array",
        "items": { "$ref": "#/definitions/html_patch" },
        "description": "Array of HTML patches to apply (usually empty unless structure changes needed)"
      },
      "testing_checklist": {
        "type": "array",
        "items": { "type": "string" },
        "minItems": 1,
        "description": "Checklist of tests to verify the fix works correctly",
        "examples": [["Inspect .task-card and verify min-height is applied", "Confirm content is fully visible without clipping", "Test with long Hebrew text"]]
      }
    }
  }
}
