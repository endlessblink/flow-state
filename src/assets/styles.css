/* Import design tokens FIRST - provides all CSS custom properties */
@import './design-tokens.css';

/* Import theme variables for dark/light mode toggle support */
@import './theme-variables.css';

/* Then Tailwind CSS - provides utility classes */
@tailwind base;
@tailwind components;
@tailwind utilities;

/* =========================================================================
   SHARED LAYOUT UTILITIES
   Reusable container patterns to reduce CSS duplication across components.
   Added Jan 2026 as part of container consolidation refactor.
   ========================================================================= */

/**
 * Flexbox scroll container - enables scrolling in nested flex layouts.
 * CRITICAL: min-height: 0 allows flex children to shrink below content size.
 * Without this, nested flex containers cannot scroll properly.
 *
 * Usage: Add .scroll-container to any flex child that needs to scroll.
 * Example: <div class="flex-1 scroll-container">...scrollable content...</div>
 */
.scroll-container {
  flex: 1;
  overflow-y: auto;
  min-height: 0;
}

/* Thin scrollbar for inbox task list (global - Vue scoped styles don't work with ::webkit-scrollbar) */
.inbox-tasks::-webkit-scrollbar {
  width: 6px;
}

.inbox-tasks::-webkit-scrollbar-track {
  background: transparent;
}

.inbox-tasks::-webkit-scrollbar-thumb {
  background: var(--glass-border);
  border-radius: var(--radius-md);
}

/* Horizontal scroll variant */
.scroll-container-x {
  flex: 1;
  overflow-x: auto;
  overflow-y: hidden;
  min-width: 0;
}

/**
 * Content section with border separator.
 * Use for grouped settings, filter sections, or any vertically stacked content.
 * Last child automatically removes bottom border.
 */
.content-section {
  display: flex;
  flex-direction: column;
  gap: var(--space-3);
  border-bottom: 1px solid var(--border-subtle);
  padding-bottom: var(--space-3);
}

.content-section:last-child {
  border-bottom: none;
  padding-bottom: 0;
}

/* =========================================================================
   END SHARED LAYOUT UTILITIES
   ========================================================================= */

/* Global reset */
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html,
body {
  font-family: ui-sans-serif, system-ui, sans-serif;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  overflow: visible;
  /* Allow canvas controls to overflow */
  height: 100vh;
  width: 100vw;

  /* PWA Mobile Support - ROAD-004 */
  overscroll-behavior: none;
  /* Prevent rubber-banding on mobile */
  padding: env(safe-area-inset-top) env(safe-area-inset-right) env(safe-area-inset-bottom) env(safe-area-inset-left);
}

#root {
  width: 100vw;
  height: 100vh;
  overflow: visible;
  /* Allow canvas controls to overflow */
  /* Ensure no borders are applied to root element */
  border: none;
  outline: none;
  box-shadow: none;
}

/* TASK-079: Canvas visibility improvements */
.canvas-contour {
  /* Brighter canvas background for better element visibility */
  background: rgba(45, 50, 60, 0.5) !important;
  border: 1px solid var(--border-medium) !important;
}

/* =========================================================================
   GLOBAL DARK MODE FOR NATIVE FORM ELEMENTS
   These styles ensure native <select>, <input> have dark backgrounds
   in ALL environments (Chromium, WebKitGTK, Firefox)
   ========================================================================= */

/* Force dark styling on ALL native select elements - purple-tinted */
select {
  background-color: #221f35 !important;
  color: #e0e0e0 !important;
  border: 1px solid var(--border-hover) !important;
  border-radius: var(--radius-md);
}

select:focus {
  outline: none;
  border-color: rgba(34, 211, 238, 0.5) !important;
}

select option {
  background-color: #221f35 !important;
  color: #e0e0e0 !important;
  padding: var(--space-2);
}

/* Specific class for filter selects with higher specificity */
.filter-controls select,
.filter-controls .filter-select,
.filter-control select,
.filter-select {
  background-color: #221f35 !important;
  color: #e0e0e0 !important;
  border: 1px solid var(--border-hover) !important;
}

/* =========================================================================
   BROWSER OPTIMIZATIONS (ZEN / FIREFOX / TAURI-WEBKIT)
   ========================================================================= */

/* Detect Firefox/Zen via feature query (backdrop-filter fallback) or vendor specific */
/* Firefox has notoriously slow backdrop-filter implementation compared to Chromium */

/* 1. Global Glass Optimization for Firefox */
@-moz-document url-prefix() {

  /* Disable heavy backdrop-filter globally on Firefox/Zen */
  .glass,
  [class*="backdrop-blur"] {
    backdrop-filter: none !important;
    background-color: rgba(35, 32, 55, 0.95) !important;
    /* Purple-tinted solid fallback */
    border: 1px solid var(--glass-border) !important;
  }

  /* Disable smooth scrolling for canvas to prevent jank */
  html,
  body {
    scroll-behavior: auto !important;
  }

  /* Optimize SVG painting */
  svg {
    shape-rendering: optimizeSpeed;
    text-rendering: optimizeSpeed;
  }
}

/* =========================================================================
   TAURI / WEBKITGTK OPTIMIZATIONS (Linux Desktop App)
   ========================================================================= */

/* Tauri WebKitGTK on Linux has limited backdrop-filter support */
/* Detect via .tauri-app class added by JavaScript or feature query fallback */

/* ========================================================================
   TAURI OPAQUE BACKGROUNDS - FULL WEB PARITY (BUG-1066)
   WebKitGTK doesn't render backdrop-filter properly, so we use opaque backgrounds
   that match the visual appearance of the web version's glass effects.
   ======================================================================== */

/* Override glass variables for Tauri - FULLY OPAQUE (BUG-1066) */
/* WebKitGTK doesn't support backdrop-filter, so we use solid colors */
.tauri-app {
  /* Glass backgrounds - FULLY OPAQUE purple-tinted */
  --glass-bg-soft: rgb(35, 32, 50) !important;
  --glass-bg-light: rgb(40, 37, 55) !important;
  --glass-bg-medium: rgb(33, 30, 48) !important;
  --glass-bg-heavy: rgb(30, 27, 44) !important;
  --glass-bg: rgb(35, 32, 50) !important;
  --glass-bg-tint: rgb(37, 34, 52) !important;
  --glass-bg-subtle: rgb(37, 34, 52) !important;

  /* Panel backgrounds - FULLY OPAQUE purple-tinted */
  --inbox-panel-bg: rgb(28, 25, 45) !important;
  --glass-panel-bg: rgb(30, 27, 48) !important;
  --dropdown-bg: rgb(28, 25, 45) !important;

  /* Overlay components - FULLY OPAQUE purple-tinted */
  --overlay-component-bg: rgb(28, 25, 45) !important;
  --overlay-component-backdrop: none !important;

  /* Kanban backgrounds - FULLY OPAQUE purple-tinted */
  --kanban-column-bg: rgb(40, 37, 55) !important;
  --kanban-card-glass-bg: rgb(35, 32, 52) !important;

  /* Surface backgrounds for components - purple-tinted */
  --surface-0: rgb(24, 21, 38) !important;
  --surface-1: rgb(30, 27, 48) !important;
  --surface-hover: rgb(40, 37, 55) !important;
}

/* When running in Tauri (class added by app initialization) */
/* Use FULLY OPAQUE backgrounds since backdrop-filter doesn't work */
.tauri-app .glass,
.tauri-app [class*="backdrop-blur"] {
  backdrop-filter: none !important;
  -webkit-backdrop-filter: none !important;
  background-color: rgb(33, 30, 48) !important;
  border: 1px solid var(--glass-border) !important;
}

.pwa-app .glass,
.pwa-app [class*="backdrop-blur"] {
  backdrop-filter: blur(12px) !important;
  -webkit-backdrop-filter: blur(12px) !important;
  background-color: var(--glass-bg-medium) !important;
  border: 1px solid var(--glass-border) !important;
}

/* Fix glass panel backgrounds - OPAQUE for Tauri */
.tauri-app .glass-panel,
.tauri-app [class*="glass-bg"] {
  background: rgb(33, 30, 48) !important;
  backdrop-filter: none !important;
  -webkit-backdrop-filter: none !important;
}

.pwa-app .glass-panel,
.pwa-app [class*="glass-bg"] {
  background: var(--glass-bg-medium) !important;
  backdrop-filter: blur(16px) !important;
  -webkit-backdrop-filter: blur(16px) !important;
}

/* Sidebar - OPAQUE for Tauri */
.tauri-app aside,
.tauri-app nav {
  background: rgb(24, 21, 38) !important;
  backdrop-filter: none !important;
  -webkit-backdrop-filter: none !important;
  box-shadow: var(--sidebar-shadow) !important;
}

.pwa-app aside,
.pwa-app nav {
  background: var(--sidebar-bg) !important;
  backdrop-filter: var(--sidebar-backdrop) !important;
  -webkit-backdrop-filter: var(--sidebar-backdrop) !important;
  box-shadow: var(--sidebar-shadow) !important;
}

/* Modal/overlay - OPAQUE for Tauri */
.tauri-app [role="dialog"],
.tauri-app .modal,
.tauri-app .n-modal {
  background: rgb(30, 27, 48) !important;
  backdrop-filter: none !important;
  -webkit-backdrop-filter: none !important;
  box-shadow: 0 16px 48px rgba(0, 0, 0, 0.6), 0 0 0 1px rgba(255, 255, 255, 0.1) !important;
}

.pwa-app [role="dialog"],
.pwa-app .modal,
.pwa-app .n-modal {
  background: var(--glass-bg-heavy) !important;
  backdrop-filter: var(--overlay-component-backdrop) !important;
  -webkit-backdrop-filter: var(--overlay-component-backdrop) !important;
  box-shadow: var(--shadow-2xl), inset 0 1px 0 rgba(255, 255, 255, 0.1) !important;
}

/* Naive UI Dropdown/Popover - OPAQUE for Tauri */
.tauri-app .n-dropdown,
.tauri-app .n-popover,
.tauri-app .n-dropdown-menu,
.tauri-app .n-popover-content {
  background: rgb(28, 25, 45) !important;
  backdrop-filter: none !important;
  -webkit-backdrop-filter: none !important;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5), 0 0 0 1px rgba(255, 255, 255, 0.1) !important;
}

.pwa-app .n-dropdown,
.pwa-app .n-popover {
  background: var(--dropdown-bg) !important;
  backdrop-filter: blur(var(--blur-regular)) !important;
  -webkit-backdrop-filter: blur(var(--blur-regular)) !important;
}

/* Naive UI Dropdown/Popover - Glass morphism fallback (Storybook + contexts without .tauri-app/.pwa-app) */
.n-dropdown-menu {
  background: rgba(35, 32, 50, 0.65) !important;
  backdrop-filter: blur(16px) !important;
  -webkit-backdrop-filter: blur(16px) !important;
  border: 1px solid rgba(255, 255, 255, 0.12) !important;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3), 0 0 0 1px rgba(255, 255, 255, 0.08) inset !important;
  border-radius: var(--radius-md) !important;
}

.n-dropdown-option-body {
  color: var(--text-primary) !important;
  font-size: var(--text-xs) !important;
}

.n-dropdown-option-body:hover,
.n-dropdown-option-body--pending {
  background: var(--surface-hover) !important;
}

/* Additional Tauri fallbacks for glass morphism classes */
.tauri-app .glass-effect,
.tauri-app .glass-surface,
.tauri-app .glass-card,
.tauri-app .glass-overlay,
.tauri-app .glass-container,
.tauri-app .task-glass,
.tauri-app .modal-glass,
.tauri-app .sidebar-glass {
  backdrop-filter: blur(16px) !important;
  -webkit-backdrop-filter: blur(16px) !important;
  background-color: var(--glass-bg-medium) !important;
  border: 1px solid var(--border-medium) !important;
}

/* Canvas-specific fallbacks */
.tauri-app .canvas-contour {
  backdrop-filter: blur(var(--blur-xs)) !important;
  -webkit-backdrop-filter: blur(var(--blur-xs)) !important;
  background: var(--canvas-group-bg) !important;
}

/* Task node fallbacks */
/* BUG-1328: backdrop-filter REMOVED from .vue-flow__node — creates compositing layers on WebKitGTK
 * that cause subpixel rounding errors in transform: translate(x,y) positioning during drag.
 * The inner .task-node already has solid opaque background (BUG-1216), so blur on the wrapper is redundant.
 * Previously: backdrop-filter: blur(4px) !important; */

/* Vue Flow pane fallbacks */
/* BUG-1328: backdrop-filter REMOVED from viewport/pane — unnecessary compositing layers
 * on the element that carries the zoom/pan transform cause coordinate precision issues.
 * Previously: backdrop-filter: blur(2px) !important; */

/* =========================================================================
   TAURI NATIVE FORM ELEMENTS FIX
   WebKitGTK renders native <select>, <input> differently from Chromium.
   CSS variables may not work - use explicit colors.
   ========================================================================= */

/* Native select dropdowns - purple-tinted for WebKitGTK */
.tauri-app select,
.tauri-app .filter-select {
  background-color: #1c1a30 !important;
  color: #e0e0e0 !important;
  border: 1px solid var(--glass-border-hover) !important;
  -webkit-appearance: menulist !important;
  appearance: menulist !important;
}

.tauri-app select option,
.tauri-app .filter-select option {
  background-color: #1c1a30 !important;
  color: #e0e0e0 !important;
}

/* Native input fields - purple-tinted */
.tauri-app input[type="text"],
.tauri-app input[type="email"],
.tauri-app input[type="password"],
.tauri-app input[type="number"],
.tauri-app input[type="search"],
.tauri-app textarea {
  background-color: #1c1a30 !important;
  color: #e0e0e0 !important;
  border: 1px solid var(--glass-border-hover) !important;
}

/* Native checkbox styling */
.tauri-app input[type="checkbox"] {
  accent-color: #22d3ee !important;
}

/* Placeholder text color */
.tauri-app input::placeholder,
.tauri-app textarea::placeholder {
  color: rgba(255, 255, 255, 0.5) !important;
  -webkit-backdrop-filter: none !important;
}

/* Component-specific glass fallbacks - Restore vibrancy */
.tauri-app .task-node-glass,
.tauri-app .command-palette-glass,
.tauri-app .context-menu-glass,
.tauri-app .sidebar-panel-glass,
.pwa-app .task-node-glass,
.pwa-app .command-palette-glass,
.pwa-app .context-menu-glass,
.pwa-app .sidebar-panel-glass {
  backdrop-filter: blur(var(--blur-lg)) !important;
  -webkit-backdrop-filter: blur(var(--blur-lg)) !important;
  background-color: var(--glass-bg-medium) !important;
  border: 1px solid var(--glass-border) !important;
}

/* =========================================================================
   COMPREHENSIVE TAURI COMPONENT FALLBACKS
   These override inline backdrop-filter styles in Vue components
   ========================================================================= */

/* Modal and Dialog - OPAQUE for Tauri (BUG-1066) */
.tauri-app .modal-overlay,
.tauri-app .modal-backdrop,
.tauri-app .dialog-overlay,
.tauri-app .base-modal-overlay {
  backdrop-filter: none !important;
  -webkit-backdrop-filter: none !important;
  background: rgba(0, 0, 0, 0.7) !important;
}

.tauri-app .modal-content,
.tauri-app .dialog-content,
.tauri-app .base-modal-content,
.tauri-app .task-edit-modal,
.tauri-app .settings-modal,
.tauri-app .batch-edit-modal,
.tauri-app .group-modal,
.tauri-app .confirmation-modal,
.tauri-app .welcome-modal,
.tauri-app .quick-task-create-modal,
.tauri-app .sync-alert-modal,
.tauri-app .conflict-resolution-dialog,
.tauri-app .manual-merge-modal {
  backdrop-filter: none !important;
  -webkit-backdrop-filter: none !important;
  background: rgb(30, 27, 48) !important;
  box-shadow: 0 16px 48px rgba(0, 0, 0, 0.5), 0 0 0 1px rgba(255, 255, 255, 0.1) !important;
}

.pwa-app .modal-overlay,
.pwa-app .modal-content,
.pwa-app .modal-backdrop,
.pwa-app .dialog-overlay,
.pwa-app .dialog-content,
.pwa-app .base-modal-overlay,
.pwa-app .base-modal-content,
.pwa-app .task-edit-modal,
.pwa-app .settings-modal,
.pwa-app .batch-edit-modal,
.pwa-app .group-modal,
.pwa-app .confirmation-modal,
.pwa-app .welcome-modal,
.pwa-app .quick-task-create-modal,
.pwa-app .sync-alert-modal,
.pwa-app .conflict-resolution-dialog,
.pwa-app .manual-merge-modal {
  backdrop-filter: blur(40px) !important;
  -webkit-backdrop-filter: blur(40px) !important;
  background: var(--glass-bg-heavy) !important;
}

/* Sidebar and Navigation - OPAQUE for Tauri (BUG-1066) */
.tauri-app .app-sidebar,
.tauri-app .sidebar-content,
.tauri-app .sidebar-smart-item,
.tauri-app .sidebar-nav,
.tauri-app .task-manager-sidebar,
.tauri-app .category-selector,
.tauri-app .filter-dropdown {
  backdrop-filter: none !important;
  -webkit-backdrop-filter: none !important;
  background: rgb(24, 21, 38) !important;
}

.pwa-app .app-sidebar,
.pwa-app .sidebar-content,
.pwa-app .sidebar-smart-item,
.pwa-app .sidebar-nav,
.pwa-app .task-manager-sidebar,
.pwa-app .category-selector,
.pwa-app .filter-dropdown {
  backdrop-filter: blur(40px) !important;
  -webkit-backdrop-filter: blur(40px) !important;
  background: var(--glass-bg-tint) !important;
}

/* Context Menu - OPAQUE for Tauri (BUG-1066) */
.tauri-app .context-menu,
.tauri-app .task-context-menu,
.tauri-app .canvas-context-menu,
.tauri-app .node-context-menu,
.tauri-app .edge-context-menu,
.tauri-app .context-menu-container,
.tauri-app .context-menu-content {
  backdrop-filter: none !important;
  -webkit-backdrop-filter: none !important;
  background: rgb(28, 25, 45) !important;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5), 0 0 0 1px rgba(255, 255, 255, 0.1) !important;
}

.pwa-app .context-menu,
.pwa-app .task-context-menu,
.pwa-app .canvas-context-menu,
.pwa-app .node-context-menu,
.pwa-app .edge-context-menu,
.pwa-app .context-menu-container,
.pwa-app .context-menu-content {
  backdrop-filter: var(--overlay-component-backdrop) !important;
  -webkit-backdrop-filter: var(--overlay-component-backdrop) !important;
  background-color: var(--glass-bg-heavy) !important;
  box-shadow: var(--shadow-xl), inset 0 1px 0 rgba(255, 255, 255, 0.08) !important;
}

/* Command Palette - OPAQUE for Tauri (BUG-1066) */
.tauri-app .command-palette,
.tauri-app .command-palette-content,
.tauri-app .search-modal,
.tauri-app .search-modal-content {
  backdrop-filter: none !important;
  -webkit-backdrop-filter: none !important;
  background: rgb(28, 25, 45) !important;
  box-shadow: 0 16px 48px rgba(0, 0, 0, 0.5), 0 0 0 1px rgba(255, 255, 255, 0.1) !important;
}

.tauri-app .command-palette-overlay {
  backdrop-filter: none !important;
  -webkit-backdrop-filter: none !important;
  background: rgba(0, 0, 0, 0.6) !important;
}

.pwa-app .command-palette,
.pwa-app .command-palette-overlay,
.pwa-app .command-palette-content,
.pwa-app .search-modal,
.pwa-app .search-modal-content {
  backdrop-filter: var(--overlay-component-backdrop) !important;
  -webkit-backdrop-filter: var(--overlay-component-backdrop) !important;
  background-color: var(--glass-bg-heavy) !important;
}

/* Canvas Components - OPAQUE for Tauri (BUG-1066) */
.tauri-app .task-node,
.tauri-app .task-node-content,
.tauri-app .group-node,
.tauri-app .group-node-simple,
.tauri-app .canvas-group,
.tauri-app .section-selector,
.tauri-app .inbox-panel,
.tauri-app .inbox-panel-header,
.tauri-app .inbox-filters,
.tauri-app .inbox-time-filters,
.tauri-app .multi-selection-overlay,
.tauri-app .canvas-empty-state {
  backdrop-filter: none !important;
  -webkit-backdrop-filter: none !important;
  background: rgb(33, 30, 50) !important;
  box-shadow: var(--shadow-md), inset 0 1px 0 rgba(255, 255, 255, 0.05) !important;
}

.pwa-app .task-node,
.pwa-app .task-node-content,
.pwa-app .group-node,
.pwa-app .group-node-simple,
.pwa-app .canvas-group,
.pwa-app .section-selector,
.pwa-app .inbox-panel,
.pwa-app .inbox-panel-header,
.pwa-app .inbox-filters,
.pwa-app .inbox-time-filters,
.pwa-app .multi-selection-overlay,
.pwa-app .canvas-empty-state {
  backdrop-filter: var(--state-active-glass) !important;
  -webkit-backdrop-filter: var(--state-active-glass) !important;
  background-color: var(--glass-bg-medium) !important;
  box-shadow: var(--shadow-md), inset 0 1px 0 rgba(255, 255, 255, 0.05) !important;
}

/* Task Cards - OPAQUE for Tauri (BUG-1066) */
.tauri-app .task-card,
.tauri-app .task-card-content,
.tauri-app .task-row,
.tauri-app .task-list,
.tauri-app .task-table,
.tauri-app .hierarchical-task-row,
.tauri-app .quick-sort-card,
.tauri-app .kanban-column,
.tauri-app .kanban-swimlane {
  backdrop-filter: none !important;
  -webkit-backdrop-filter: none !important;
  background: rgb(37, 34, 52) !important;
  box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.04) !important;
}

.pwa-app .task-card,
.pwa-app .task-card-content,
.pwa-app .task-row,
.pwa-app .task-list,
.pwa-app .task-table,
.pwa-app .hierarchical-task-row,
.pwa-app .quick-sort-card,
.pwa-app .kanban-column,
.pwa-app .kanban-swimlane {
  backdrop-filter: blur(16px) saturate(120%) !important;
  -webkit-backdrop-filter: blur(16px) saturate(120%) !important;
  background-color: var(--glass-bg-subtle) !important;
  box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.03) !important;
}

/* Dropdowns and Popovers - OPAQUE for Tauri (BUG-1066) */
.tauri-app .base-dropdown,
.tauri-app .base-dropdown-content,
.tauri-app .base-popover,
.tauri-app .base-popover-content,
.tauri-app .custom-select,
.tauri-app .custom-select-dropdown,
.tauri-app .emoji-picker,
.tauri-app .emoji-picker-content,
.tauri-app .project-filter-dropdown,
.tauri-app .select-dropdown {
  backdrop-filter: none !important;
  -webkit-backdrop-filter: none !important;
  background: rgb(28, 25, 45) !important;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5), 0 0 0 1px rgba(255, 255, 255, 0.1) !important;
}

.pwa-app .base-dropdown,
.pwa-app .base-dropdown-content,
.pwa-app .base-popover,
.pwa-app .base-popover-content,
.pwa-app .custom-select,
.pwa-app .custom-select-dropdown,
.pwa-app .emoji-picker,
.pwa-app .emoji-picker-content,
.pwa-app .project-filter-dropdown {
  backdrop-filter: var(--overlay-component-backdrop) saturate(140%) !important;
  -webkit-backdrop-filter: var(--overlay-component-backdrop) saturate(140%) !important;
  background: var(--glass-bg-soft) !important;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.6), inset 0 1px 0 rgba(255, 255, 255, 0.1) !important;
}

/* CustomSelect specific fallbacks */
.pwa-app .select-dropdown {
  backdrop-filter: var(--overlay-component-backdrop) !important;
  -webkit-backdrop-filter: var(--overlay-component-backdrop) !important;
  background: var(--dropdown-bg) !important;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5) !important;
  border: 1px solid var(--glass-border) !important;
  overflow: hidden !important;
}

.tauri-app .select-trigger,
.pwa-app .select-trigger {
  backdrop-filter: blur(8px) !important;
  -webkit-backdrop-filter: blur(8px) !important;
  background: var(--glass-bg-tint) !important;
  border: 1px solid var(--glass-border) !important;
  box-shadow: none !important;
}

.tauri-app .select-trigger:hover {
  background: var(--glass-bg-soft) !important;
  border-color: var(--border-subtle) !important;
  box-shadow: none !important;
}

.tauri-app .select-trigger:focus {
  border-color: rgba(78, 205, 196, 0.3) !important;
  box-shadow: none !important;
}

.tauri-app .select-trigger.is-open {
  background: var(--glass-bg-soft) !important;
  border-color: rgba(78, 205, 196, 0.3) !important;
  box-shadow: none !important;
}

.tauri-app .select-option {
  background: transparent !important;
  border-color: transparent !important;
}

.tauri-app .select-option:hover,
.tauri-app .select-option.is-focused {
  background: var(--glass-bg-soft) !important;
  border-color: transparent !important;
}

.tauri-app .select-option.is-selected {
  background: var(--brand-primary-bg-subtle) !important;
  border-color: rgba(78, 205, 196, 0.3) !important;
}

.tauri-app .select-option.is-selected:hover {
  background: var(--brand-primary-bg-medium) !important;
}

/* Button and Interactive Element fallbacks */
.tauri-app .base-button-glass,
.tauri-app .base-nav-item,
.tauri-app .view-controls,
.tauri-app .filter-controls,
.tauri-app .multi-select-toggle,
.tauri-app .done-toggle,
.tauri-app .drag-handle {
  /* backdrop-filter: none !important; */
  /* -webkit-backdrop-filter: none !important; */
  /* background: rgba(30, 32, 40, 0.95) !important; */
}

/* Calendar Component - OPAQUE for Tauri (BUG-1066) */
.tauri-app .calendar-day-view,
.tauri-app .calendar-week-view,
.tauri-app .calendar-header,
.tauri-app .calendar-inbox-panel,
.tauri-app .calendar-status-overlays {
  backdrop-filter: none !important;
  -webkit-backdrop-filter: none !important;
  background: rgb(30, 27, 48) !important;
  box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.05) !important;
}

.pwa-app .calendar-day-view,
.pwa-app .calendar-week-view,
.pwa-app .calendar-header,
.pwa-app .calendar-inbox-panel,
.pwa-app .calendar-status-overlays,
.pwa-app .unified-inbox-panel {
  backdrop-filter: blur(var(--blur-xl)) !important;
  -webkit-backdrop-filter: blur(var(--blur-xl)) !important;
  background-color: var(--glass-bg-medium) !important;
  box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.05) !important;
}

/* ========================================
   Tauri Inbox Panel - Complete Web Parity (BUG-1066)
   Ensures inbox looks identical to web version
   ======================================== */

/* Main Panel Container - FULLY OPAQUE */
.tauri-app .unified-inbox-panel {
  backdrop-filter: none !important;
  -webkit-backdrop-filter: none !important;
  background: rgb(28, 25, 45) !important;
  box-shadow:
    inset 0 1px 0 rgba(255, 255, 255, 0.06),
    0 8px 32px rgba(0, 0, 0, 0.4) !important;
  border: 1px solid rgba(255, 255, 255, 0.08) !important;
}

/* Header Section */
.tauri-app .unified-inbox-panel .inbox-header {
  background: transparent !important;
  border-bottom-color: rgba(255, 255, 255, 0.08) !important;
}

/* Collapse Button */
.tauri-app .unified-inbox-panel .collapse-btn {
  background: rgba(255, 255, 255, 0.05) !important;
  border-color: rgba(255, 255, 255, 0.1) !important;
}

.tauri-app .unified-inbox-panel .collapse-btn:hover {
  background: rgba(255, 255, 255, 0.1) !important;
}

/* Time Filter Dropdown */
.tauri-app .unified-inbox-panel .time-filter-dropdown {
  background: transparent !important;
}

.tauri-app .unified-inbox-panel .time-filter-dropdown:hover {
  background: rgba(255, 255, 255, 0.08) !important;
}

.tauri-app .unified-inbox-panel .time-filter-dropdown.active {
  background: rgba(78, 205, 196, 0.15) !important;
}

/* Done Toggle Button - Inactive state is subtle/muted */
.tauri-app .unified-inbox-panel .done-toggle-btn {
  background: transparent !important;
  border-color: rgba(255, 255, 255, 0.08) !important;
  color: rgba(148, 163, 184, 1) !important;
}

.tauri-app .unified-inbox-panel .done-toggle-btn:hover {
  background: rgba(255, 255, 255, 0.08) !important;
}

/* Done Toggle Button - Active state shows green */
.tauri-app .unified-inbox-panel .done-toggle-btn.active {
  background: rgba(34, 197, 94, 0.15) !important;
  border-color: rgb(34, 197, 94) !important;
  color: rgb(34, 197, 94) !important;
}

.tauri-app .unified-inbox-panel .done-toggle-btn.active:hover {
  background: rgba(34, 197, 94, 0.25) !important;
}

/* Filter Chips Section */
.tauri-app .unified-inbox-panel .group-filter-chips {
  background: rgba(0, 0, 0, 0.2) !important;
  border-bottom-color: rgba(255, 255, 255, 0.06) !important;
}

.tauri-app .unified-inbox-panel .group-chip {
  background: rgba(255, 255, 255, 0.05) !important;
  border-color: rgba(255, 255, 255, 0.1) !important;
}

.tauri-app .unified-inbox-panel .group-chip:hover {
  background: rgba(255, 255, 255, 0.1) !important;
}

/* Advanced Filters Section */
.tauri-app .unified-inbox-panel .advanced-filters-section {
  background: rgba(0, 0, 0, 0.15) !important;
  border-bottom-color: rgba(255, 255, 255, 0.06) !important;
}

.tauri-app .unified-inbox-panel .toggle-filters-btn {
  background: transparent !important;
}

.tauri-app .unified-inbox-panel .toggle-filters-btn:hover {
  background: rgba(255, 255, 255, 0.06) !important;
}

/* Quick Add Input */
.tauri-app .unified-inbox-panel .quick-add {
  background: transparent !important;
  border-bottom-color: rgba(255, 255, 255, 0.08) !important;
}

.tauri-app .unified-inbox-panel .quick-add-input {
  background: rgba(255, 255, 255, 0.05) !important;
  border-color: rgba(255, 255, 255, 0.1) !important;
}

.tauri-app .unified-inbox-panel .quick-add-input:focus {
  background: rgba(255, 255, 255, 0.08) !important;
  border-color: var(--brand-primary) !important;
}

/* Mic Button */
.tauri-app .unified-inbox-panel .mic-btn {
  background: rgba(255, 255, 255, 0.05) !important;
}

.tauri-app .unified-inbox-panel .mic-btn:hover:not(:disabled) {
  background: rgba(255, 255, 255, 0.1) !important;
}

/* Task Cards */
.tauri-app .unified-inbox-panel .task-card {
  background: rgba(255, 255, 255, 0.04) !important;
  border-color: rgba(255, 255, 255, 0.08) !important;
}

.tauri-app .unified-inbox-panel .task-card:hover {
  background: rgba(255, 255, 255, 0.07) !important;
  border-color: rgba(255, 255, 255, 0.12) !important;
}

.tauri-app .unified-inbox-panel .task-card.selected {
  background: rgba(78, 205, 196, 0.12) !important;
  border-color: var(--brand-primary) !important;
}

.tauri-app .unified-inbox-panel .task-card.is-done {
  background: rgba(34, 197, 94, 0.08) !important;
  border-color: rgba(34, 197, 94, 0.2) !important;
}

/* Task Actions Popup */
.tauri-app .unified-inbox-panel .task-actions {
  background: rgba(35, 32, 55, 0.95) !important;
}

/* Project Badge */
.tauri-app .unified-inbox-panel .project-badge {
  background: rgba(255, 255, 255, 0.06) !important;
}

/* Selection Bar */
.tauri-app .unified-inbox-panel .selection-bar {
  background: var(--brand-primary) !important;
}

/* Scrollbar styling */
.tauri-app .unified-inbox-panel .inbox-tasks {
  scrollbar-color: rgba(255, 255, 255, 0.2) transparent !important;
}

/* Empty State */
.tauri-app .unified-inbox-panel .empty-inbox {
  color: rgba(255, 255, 255, 0.5) !important;
}

/* Voice Feedback Panel */
.tauri-app .unified-inbox-panel .voice-feedback {
  background: rgba(255, 255, 255, 0.05) !important;
  border-color: rgba(255, 255, 255, 0.1) !important;
}

/* Voice Mode Toggle */
.tauri-app .unified-inbox-panel .mode-btn {
  background: rgba(255, 255, 255, 0.05) !important;
  border-color: rgba(255, 255, 255, 0.1) !important;
}

.tauri-app .unified-inbox-panel .mode-btn:hover:not(:disabled) {
  background: rgba(255, 255, 255, 0.1) !important;
}

.tauri-app .unified-inbox-panel .mode-btn.active {
  background: rgba(59, 130, 246, 0.15) !important;
  border-color: var(--brand-primary) !important;
}

/* Sync and System UI fallbacks - Iteration 3 - VIBRANT */
.tauri-app .sync-status,
.tauri-app .sync-health-dashboard,
.tauri-app .sync-alert-system,
.tauri-app .backup-settings,
.tauri-app .backup-verification,
.tauri-app .sync-integration,
.tauri-app .user-profile,
.tauri-app .auth-status-notice,
.tauri-app .error-boundary,
.pwa-app .sync-status,
.pwa-app .sync-health-dashboard,
.pwa-app .sync-alert-system,
.pwa-app .backup-settings,
.pwa-app .backup-verification,
.pwa-app .sync-integration,
.pwa-app .user-profile,
.pwa-app .auth-status-notice,
.pwa-app .error-boundary {
  backdrop-filter: var(--overlay-component-backdrop) !important;
  -webkit-backdrop-filter: var(--overlay-component-backdrop) !important;
  background-color: var(--glass-bg-medium) !important;
  box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.05) !important;
}

/* Base component fallbacks - Iteration 3 - UNIFIED */
.tauri-app .base-card,
.tauri-app .base-modal,
.tauri-app .time-display,
.tauri-app .sort-progress,
.tauri-app .quick-task-create,
.pwa-app .base-card,
.pwa-app .base-modal,
.pwa-app .time-display,
.pwa-app .sort-progress,
.pwa-app .quick-task-create {
  backdrop-filter: var(--overlay-component-backdrop) !important;
  -webkit-backdrop-filter: var(--overlay-component-backdrop) !important;
  background-color: var(--glass-bg-soft) !important;
  box-shadow: var(--shadow-lg), inset 0 1px 0 rgba(255, 255, 255, 0.08) !important;
}

/* Project indicator fallbacks */
.tauri-app .project-emoji-icon,
.tauri-app [class*="project-indicator"] {
  backdrop-filter: blur(4px) !important;
  -webkit-backdrop-filter: blur(4px) !important;
}

/* WebKitGTK-specific fixes using @supports */
/* Fallback for when backdrop-filter doesn't work properly */
@supports not ((-webkit-backdrop-filter: blur(1px)) or (backdrop-filter: blur(1px))) {

  .glass,
  [class*="backdrop-blur"],
  .glass-panel {
    backdrop-filter: none !important;
    -webkit-backdrop-filter: none !important;
    background-color: rgba(30, 27, 45, 0.98) !important;
    border: 1px solid var(--border-medium) !important;
  }

  /* Native form elements for WebKitGTK - purple-tinted */
  select,
  .filter-select {
    background-color: #1c1a30 !important;
    color: #e0e0e0 !important;
    border: 1px solid var(--glass-border-hover) !important;
  }

  select option,
  .filter-select option {
    background-color: #1c1a30 !important;
    color: #e0e0e0 !important;
  }

  input[type="text"],
  input[type="email"],
  input[type="password"],
  input[type="number"],
  input[type="search"],
  textarea {
    background-color: #1c1a30 !important;
    color: #e0e0e0 !important;
    border: 1px solid var(--glass-border-hover) !important;
  }
}

/* Tauri layout fixes - ensure proper sizing within desktop window */
.tauri-app #app,
.tauri-app #root,
.pwa-app #app,
.pwa-app #root {
  min-height: 100vh;
  min-width: 100vw;
  overflow: hidden;
}

/* Layout fixes - Prevent Tauri and PWA horizontal scrollbar issues */
.tauri-app,
.pwa-app {
  overflow-x: hidden;
  -webkit-font-smoothing: antialiased;
  text-rendering: optimizeLegibility;
  font-feature-settings: "kern" 1, "liga" 1;
}

/* Explicit control panel glass for Iteration 3 parity */
.tauri-app .control-panel,
.pwa-app .control-panel {
  backdrop-filter: var(--overlay-component-backdrop) !important;
  -webkit-backdrop-filter: var(--overlay-component-backdrop) !important;
  background-color: var(--glass-bg-medium) !important;
  box-shadow: var(--shadow-xl), inset 0 1px 0 rgba(255, 255, 255, 0.1) !important;
}

/* 2. Vue Flow Specific Optimizations */
/* BUG-1328: will-change: transform REMOVED from renderer — creates unnecessary
 * compositing layer that on WebKitGTK can cause coordinate calculation imprecision.
 * vue-flow-overrides.css sets will-change: auto on viewport and nodes explicitly. */

/* When panned/zoomed, reduce painting */
.vue-flow__pane.dragging,
.vue-flow__viewport.dragging {
  pointer-events: none;
  /* Disable hover effects during drag */
}